<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸºäºBunå’ŒBabelçš„CLIé™æ€åˆ†æå·¥å…·æŠ€æœ¯æ–‡æ¡£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        h2 {
            color: #34495e;
            margin: 25px 0 15px;
            padding-left: 10px;
            border-left: 4px solid #3498db;
        }
        
        h3 {
            color: #7f8c8d;
            margin: 20px 0 10px;
        }
        
        p {
            margin-bottom: 15px;
            text-indent: 2em;
        }
        
        code {
            background-color: #f0f0f0;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
        }
        
        pre {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        pre code {
            background-color: transparent;
            padding: 0;
        }
        
        ul, ol {
            margin: 15px 0;
            padding-left: 40px;
        }
        
        li {
            margin-bottom: 5px;
        }
        
        .directory-tree {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-family: 'Courier New', Courier, monospace;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 15px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        table th, table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        
        .module-card {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .highlight {
            background-color: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>åŸºäºBunå’ŒBabelçš„CLIé™æ€åˆ†æå·¥å…·æŠ€æœ¯æ–‡æ¡£</h1>
        
        <h2>1. é¡¹ç›®æ¦‚è¿°</h2>
        <p>æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºBunå’ŒBabelçš„CLIé™æ€åˆ†æå·¥å…·ï¼ŒåŠŸèƒ½ç±»ä¼¼ESLintï¼Œç”¨äºæ£€æµ‹JavaScript/TypeScriptä»£ç ä¸­çš„æ½œåœ¨é—®é¢˜å’Œå®‰å…¨é£é™©ã€‚å·¥å…·é€šè¿‡Babelè¿›è¡Œä»£ç è§£æå’ŒASTéå†ï¼Œå®ç°è‡ªå®šä¹‰è§„åˆ™æ£€æŸ¥å’Œå¤šæ ¼å¼æŠ¥å‘Šç”Ÿæˆã€‚</p>
        
        <h2>2. æ–‡ä»¶ç›®å½•ç»“æ„</h2>
        <div class="directory-tree">
            c:/develop/code/personal/jsast/<br>
            â”œâ”€â”€ .gitignore          # Gitå¿½ç•¥é…ç½®<br>
            â”œâ”€â”€ .prettierrc         # Prettierä»£ç æ ¼å¼åŒ–é…ç½®<br>
            â”œâ”€â”€ README.md           # é¡¹ç›®è¯´æ˜æ–‡æ¡£<br>
            â”œâ”€â”€ bun.lock            # Bunä¾èµ–é”å®šæ–‡ä»¶<br>
            â”œâ”€â”€ package.json        # é¡¹ç›®é…ç½®å’Œä¾èµ–<br>
            â”œâ”€â”€ tsconfig.json       # TypeScripté…ç½®<br>
            â”œâ”€â”€ demo.ts             # æ¼”ç¤ºæ–‡ä»¶<br>
            â”œâ”€â”€ docs.html           # æŠ€æœ¯æ–‡æ¡£ï¼ˆå½“å‰æ–‡ä»¶ï¼‰<br>
            â”œâ”€â”€ sarif.json          # ç”Ÿæˆçš„SARIFæ ¼å¼æŠ¥å‘Šï¼ˆç¤ºä¾‹ï¼‰<br>
            â”œâ”€â”€ src/                # æºä»£ç ç›®å½•<br>
            â”‚   â”œâ”€â”€ __test__/       # æµ‹è¯•ç›®å½•<br>
            â”‚   â”œâ”€â”€ cli/            # CLIå·¥å…·ç›¸å…³<br>
            â”‚   â”‚   â”œâ”€â”€ index.ts    # CLIå…¥å£<br>
            â”‚   â”‚   â”œâ”€â”€ options.ts  # å‘½ä»¤è¡Œé€‰é¡¹å®šä¹‰<br>
            â”‚   â”‚   â””â”€â”€ runner.ts   # åˆ†æä»»åŠ¡æ‰§è¡Œå™¨<br>
            â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—<br>
            â”‚   â”‚   â”œâ”€â”€ index.ts    # æ ¸å¿ƒæ¨¡å—å¯¼å‡º<br>
            â”‚   â”‚   â””â”€â”€ src/        # æ ¸å¿ƒå®ç°ä»£ç <br>
            â”‚   â”‚       â”œâ”€â”€ analyzer.ts # é™æ€åˆ†æå™¨ä¸»ç±»<br>
            â”‚   â”‚       â”œâ”€â”€ parser.ts   # ä»£ç è§£ææ¨¡å—<br>
            â”‚   â”‚       â””â”€â”€ traverser.ts # ASTéå†æ¨¡å—<br>
            â”‚   â”œâ”€â”€ main.ts         # é¡¹ç›®ä¸»å…¥å£æ–‡ä»¶<br>
            â”‚   â”œâ”€â”€ report/         # æŠ¥å‘Šç”Ÿæˆæ¨¡å—<br>
            â”‚   â”‚   â”œâ”€â”€ index.ts    # æŠ¥å‘Šæ¨¡å—å¯¼å‡º<br>
            â”‚   â”‚   â”œâ”€â”€ reporter.ts # æ§åˆ¶å°æŠ¥å‘Šç”Ÿæˆå™¨<br>
            â”‚   â”‚   â””â”€â”€ sarif-generator.ts # SARIFæ ¼å¼æŠ¥å‘Šç”Ÿæˆå™¨<br>
            â”‚   â”œâ”€â”€ rules/          # è§„åˆ™å®šä¹‰ç›®å½•<br>
            â”‚   â”‚   â”œâ”€â”€ index.ts    # è§„åˆ™å¯¼å‡ºå…¥å£<br>
            â”‚   â”‚   â”œâ”€â”€ no-console-log.ts # ç¦æ­¢console.logè§„åˆ™<br>
            â”‚   â”‚   â”œâ”€â”€ no-var.ts   # ç¦æ­¢varå…³é”®å­—è§„åˆ™<br>
            â”‚   â”‚   â””â”€â”€ no-command-injection.ts # å‘½ä»¤è¡Œæ³¨å…¥æ£€æµ‹è§„åˆ™<br>
            â”‚   â””â”€â”€ utils/          # å·¥å…·å‡½æ•°<br>
            â”‚       â””â”€â”€ file-utils.ts # æ–‡ä»¶ç³»ç»Ÿæ“ä½œå·¥å…·<br>
            â””â”€â”€ test-case/          # æµ‹è¯•ç”¨ä¾‹ç›®å½•<br>
                â””â”€â”€ test.js         # æµ‹è¯•æ–‡ä»¶<br>
        </div>
        
        <h2>3. å„ä¸ªæ¨¡å—çš„ä½œç”¨</h2>
        
        <h3>3.1 src/core/ - æ ¸å¿ƒåŠŸèƒ½æ¨¡å—</h3>
        <div class="module-card">
            <h4>index.ts</h4>
            <ul>
                <li>æ ¸å¿ƒæ¨¡å—çš„ç»Ÿä¸€å¯¼å‡ºå…¥å£</li>
                <li>å¯¼å‡ºæ ¸å¿ƒç±»å‹ï¼šRule, ReportIssue</li>
                <li>å¯¼å‡ºæ ¸å¿ƒç±»å’Œå‡½æ•°ï¼šStaticAnalyzer, parseCode, traverseAndCheck</li>
                <li>ç®€åŒ–å…¶ä»–æ¨¡å—å¯¹æ ¸å¿ƒåŠŸèƒ½çš„è®¿é—®ï¼Œæä¾›å•ä¸€å¯¼å…¥ç‚¹</li>
            </ul>
            
            <h4>src/analyzer.ts</h4>
            <ul>
                <li>é™æ€åˆ†æå™¨ä¸»ç±»ï¼Œåè°ƒå„ä¸ªæ¨¡å—çš„å·¥ä½œ</li>
                <li>ç®¡ç†è§„åˆ™é›†åˆ</li>
                <li>æä¾›æ–‡ä»¶åˆ†æçš„ä¸»å…¥å£</li>
                <li>æ ¸å¿ƒæ–¹æ³•ï¼š<code>analyzeFile(filename: string, code: string)</code></li>
            </ul>
            
            <h4>src/parser.ts</h4>
            <ul>
                <li>è´Ÿè´£ä»£ç è§£æï¼Œå°†æºä»£ç è½¬æ¢ä¸ºAST</li>
                <li>å°è£…@babel/parserçš„åŠŸèƒ½</li>
                <li>å¤„ç†ä¸åŒç±»å‹æ–‡ä»¶çš„è§£æé…ç½®ï¼ˆJS/TS/JSXï¼‰</li>
                <li>æ ¸å¿ƒæ–¹æ³•ï¼š<code>parseCode(code: string, filename: string)</code></li>
            </ul>
            
            <h4>src/traverser.ts</h4>
            <ul>
                <li>è´Ÿè´£ASTçš„éå†</li>
                <li>å°è£…@babel/traverseçš„åŠŸèƒ½</li>
                <li>å®šä¹‰Ruleå’ŒReportIssueæ¥å£</li>
                <li>æ ¸å¿ƒæ–¹æ³•ï¼š<code>traverseAndCheck(ast: File, rules: Rule[], filename: string)</code></li>
            </ul>
        </div>
        
        <h3>3.2 src/rules/ - è§„åˆ™å®šä¹‰æ¨¡å—</h3>
        <div class="module-card">
            <h4>è§„åˆ™æ¥å£å®šä¹‰</h4>
            <pre><code>interface Rule {
  name: string;
  description: string;
  check: (node: Node, filename: string) => ReportIssue[];
}</code></pre>
            
            <h4>index.ts</h4>
            <ul>
                <li>è§„åˆ™çš„ç»Ÿä¸€å¯¼å‡ºå…¥å£</li>
                <li>ç®¡ç†æ‰€æœ‰å¯ç”¨è§„åˆ™çš„æ³¨å†Œå’Œè·å–</li>
                <li>æä¾›è§„åˆ™æŸ¥è¯¢æ¥å£</li>
            </ul>
            
            <h4>åŸºç¡€è§„åˆ™</h4>
            <ul>
                <li><code>no-console-log.ts</code>: ç¦æ­¢ä½¿ç”¨console.log</li>
                <li><code>no-var.ts</code>: ç¦æ­¢ä½¿ç”¨varå…³é”®å­—</li>
            </ul>
            
            <h4>å®‰å…¨è§„åˆ™</h4>
            <ul>
                <li><code>no-command-injection.ts</code>: æ£€æµ‹å‘½ä»¤è¡Œæ³¨å…¥é£é™©ï¼Œè¯†åˆ«ä¸å®‰å…¨çš„child_processä½¿ç”¨æ–¹å¼</li>
            </ul>
        </div>
        
        <h3>3.3 src/report/ - æŠ¥å‘Šç”Ÿæˆæ¨¡å—</h3>
        <div class="module-card">
            <h4>index.ts</h4>
            <ul>
                <li>æŠ¥å‘Šæ¨¡å—çš„ç»Ÿä¸€å¯¼å‡ºå…¥å£</li>
                <li>å¯¼å‡ºæ‰€æœ‰æŠ¥å‘Šç”Ÿæˆå™¨ï¼šConsoleReporter, SarifGenerator</li>
            </ul>
            
            <h4>é—®é¢˜å®šä¹‰</h4>
            <pre><code>interface ReportIssue {
  rule: string;
  message: string;
  line: number;
  column: number;
  filename: string;
}</code></pre>
            
            <h4>reporter.ts</h4>
            <ul>
                <li>æ§åˆ¶å°æŠ¥å‘Šç”Ÿæˆå™¨</li>
                <li>å°†æ£€æŸ¥ç»“æœä»¥æ ¼å¼åŒ–çš„æ–¹å¼è¾“å‡ºåˆ°æ§åˆ¶å°</li>
                <li>æ”¯æŒæŒ‰æ–‡ä»¶åˆ†ç»„æ˜¾ç¤ºé—®é¢˜</li>
                <li>æ ¸å¿ƒæ–¹æ³•ï¼š<code>generateReport(issues: ReportIssue[])</code></li>
            </ul>
            
            <h4>sarif-generator.ts</h4>
            <ul>
                <li>SARIFæ ¼å¼æŠ¥å‘Šç”Ÿæˆå™¨</li>
                <li>å°†æ£€æŸ¥ç»“æœè½¬æ¢ä¸ºSARIFï¼ˆStatic Analysis Results Interchange Formatï¼‰æ ¼å¼</li>
                <li>æ”¯æŒä¿å­˜æŠ¥å‘Šåˆ°æ–‡ä»¶</li>
                <li>æ ¸å¿ƒæ–¹æ³•ï¼š
                    <ul>
                        <li><code>generateSarifReport(issues: ReportIssue[])</code> - ç”ŸæˆSARIFæ ¼å¼æŠ¥å‘Š</li>
                        <li><code>saveSarifReport(issues: ReportIssue[], outputPath?: string)</code> - ä¿å­˜SARIFæŠ¥å‘Šåˆ°æ–‡ä»¶</li>
                    </ul>
                </li>
            </ul>
        </div>
        
        <h3>3.4 src/utils/ - å·¥å…·å‡½æ•°æ¨¡å—</h3>
        <div class="module-card">
            <h4>file-utils.ts</h4>
            <ul>
                <li>æ–‡ä»¶ç³»ç»Ÿæ“ä½œå·¥å…·å‡½æ•°</li>
                <li>æä¾›æ–‡ä»¶è¯»å–ã€æ–‡ä»¶ç±»å‹åˆ¤æ–­ã€ç›®å½•éå†ç­‰åŠŸèƒ½</li>
                <li>æ ¸å¿ƒæ–¹æ³•ï¼š</li>
                <ul>
                    <li><code>readFile(filepath: string): Promise<string></code> - è¯»å–æ–‡ä»¶å†…å®¹</li>
                    <li><code>isJsOrTsFile(filename: string): boolean</code> - æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºJS/TSæ–‡ä»¶</li>
                    <li><code>getJsTsFilesInDirectory(dirPath: string): Promise<string[]></code> - è·å–ç›®å½•ä¸‹æ‰€æœ‰JS/TSæ–‡ä»¶</li>
                </ul>
            </ul>
        </div>
        
        <h3>3.5 src/main.ts - ä¼ ç»Ÿå…¥å£æ–‡ä»¶</h3>
        <div class="module-card">
            <ul>
                <li>é¡¹ç›®çš„ä¼ ç»Ÿå…¥å£ç‚¹ï¼Œæä¾›ç®€å•çš„å‘½ä»¤è¡Œæ¥å£</li>
                <li>æ”¯æŒåˆ†æå•ä¸ªæ–‡ä»¶æˆ–ç›®å½•ä¸‹çš„æ‰€æœ‰JS/TSæ–‡ä»¶</li>
                <li>å†…éƒ¨ä½¿ç”¨StaticAnalyzerè¿›è¡Œåˆ†æï¼Œè‡ªåŠ¨ç”Ÿæˆæ§åˆ¶å°æŠ¥å‘Šå’ŒSARIFæŠ¥å‘Š</li>
                <li>åŠŸèƒ½ä¸Šä¸CLIå·¥å…·éƒ¨åˆ†é‡å ï¼Œä½†æ¥å£æ›´ç®€å•</li>
            </ul>
        </div>
        
        <h3>3.6 src/cli/ - CLIå·¥å…·æ¨¡å—</h3>
        <div class="module-card">
            <h4>index.ts</h4>
            <ul>
                <li>CLIå·¥å…·çš„ä¸»å…¥å£</li>
                <li>ä½¿ç”¨commanderåº“è§£æå‘½ä»¤è¡Œå‚æ•°</li>
                <li>åè°ƒCLIå·¥ä½œæµç¨‹</li>
                <li>æ”¯æŒçš„å‚æ•°ï¼šè·¯å¾„ã€æŠ¥å‘Šæ ¼å¼ã€è§„åˆ™é€‰æ‹©ã€é™é»˜æ¨¡å¼</li>
            </ul>
            
            <h4>options.ts</h4>
            <ul>
                <li>å®šä¹‰CLIé€‰é¡¹æ¥å£</li>
                <li>æä¾›é€‰é¡¹éªŒè¯é€»è¾‘</li>
                <li>ç¡®ä¿ç”¨æˆ·è¾“å…¥çš„å‚æ•°æœ‰æ•ˆ</li>
            </ul>
            
            <h4>runner.ts</h4>
            <ul>
                <li>æ‰§è¡Œåˆ†æä»»åŠ¡çš„æ ¸å¿ƒé€»è¾‘</li>
                <li>å¤„ç†æ–‡ä»¶æˆ–ç›®å½•çš„åˆ†æè¯·æ±‚</li>
                <li>ç®¡ç†æŠ¥å‘Šç”Ÿæˆè¿‡ç¨‹</li>
                <li>æ”¯æŒé€‰æ‹©ç‰¹å®šè§„åˆ™</li>
            </ul>
        </div>
        
        <h3>3.6 test-case/ - æµ‹è¯•ç”¨ä¾‹ç›®å½•</h3>
        <div class="module-card">
            <h4>test.js</h4>
            <ul>
                <li>åŒ…å«å„ç§è§„åˆ™è¿åæƒ…å†µçš„æµ‹è¯•æ–‡ä»¶</li>
                <li>ç”¨äºéªŒè¯å·¥å…·çš„è§„åˆ™æ£€æµ‹èƒ½åŠ›</li>
                <li>åŒ…å«varå…³é”®å­—ã€console.logå’Œå‘½ä»¤è¡Œæ³¨å…¥ç­‰æµ‹è¯•æ¡ˆä¾‹</li>
            </ul>
        </div>
        
        <h2>4. æŠ€æœ¯æ ˆ</h2>
        <table>
            <tr>
                <th>æŠ€æœ¯</th>
                <th>ç‰ˆæœ¬</th>
                <th>ç”¨é€”</th>
            </tr>
            <tr>
                <td>Bun</td>
                <td>latest</td>
                <td>è¿è¡Œæ—¶å’ŒåŒ…ç®¡ç†å™¨</td>
            </tr>
            <tr>
                <td>TypeScript</td>
                <td>^5</td>
                <td>å¼€å‘è¯­è¨€ï¼Œæä¾›ç±»å‹å®‰å…¨</td>
            </tr>
            <tr>
                <td>@babel/parser</td>
                <td>^7.28.5</td>
                <td>ä»£ç è§£æï¼Œç”ŸæˆAST</td>
            </tr>
            <tr>
                <td>@babel/traverse</td>
                <td>^7.28.5</td>
                <td>ASTéå†</td>
            </tr>
            <tr>
                <td>@babel/types</td>
                <td>^7.28.5</td>
                <td>ASTèŠ‚ç‚¹ç±»å‹å®šä¹‰</td>
            </tr>
            <tr>
                <td>commander</td>
                <td>^14.0.2</td>
                <td>å‘½ä»¤è¡Œå‚æ•°è§£æ</td>
            </tr>
        </table>
        
        <h2>5. æŠ€æœ¯åŸç†</h2>
        
        <h3>5.1 é™æ€åˆ†ææµç¨‹</h3>
        <ol>
            <li><strong>Parseï¼ˆè§£æï¼‰</strong>ï¼šä½¿ç”¨@babel/parserå°†ä»£ç è§£æä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰</li>
            <li><strong>Traverseï¼ˆéå†ï¼‰</strong>ï¼šä½¿ç”¨@babel/traverseéå†ASTçš„æ¯ä¸ªèŠ‚ç‚¹</li>
            <li><strong>Rule Checkï¼ˆè§„åˆ™æ£€æŸ¥ï¼‰</strong>ï¼šå¯¹æ¯ä¸ªèŠ‚ç‚¹åº”ç”¨æ‰€æœ‰è§„åˆ™è¿›è¡Œæ£€æŸ¥</li>
            <li><strong>Reportï¼ˆæŠ¥å‘Šï¼‰</strong>ï¼šæ”¶é›†æ‰€æœ‰è§„åˆ™å‘ç°çš„é—®é¢˜ï¼Œç”Ÿæˆæ ¼å¼åŒ–æŠ¥å‘Š</li>
        </ol>
        
        <h3>5.2 ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰</h3>
        <p>ASTæ˜¯ä»£ç çš„æŠ½è±¡è¡¨ç¤ºï¼Œå°†ä»£ç ç»“æ„åŒ–ä¸ºæ ‘çŠ¶æ•°æ®ç»“æ„ã€‚æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä»£ç ä¸­çš„ä¸€ä¸ªè¯­æ³•ç»“æ„ï¼Œå¦‚å‡½æ•°è°ƒç”¨ã€å˜é‡å£°æ˜ç­‰ã€‚é™æ€åˆ†æå·¥å…·é€šè¿‡åˆ†æè¿™äº›èŠ‚ç‚¹æ¥æ£€æµ‹æ½œåœ¨é—®é¢˜ã€‚</p>
        
        <h3>5.3 å‘½ä»¤è¡Œæ³¨å…¥æ£€æµ‹åŸç†</h3>
        <div class="highlight">
            <p>å‘½ä»¤è¡Œæ³¨å…¥è§„åˆ™é€šè¿‡æ£€æµ‹ä»¥ä¸‹æ¨¡å¼è¯†åˆ«å®‰å…¨é£é™©ï¼š</p>
            <ul>
                <li><code>child_process.exec('å‘½ä»¤å­—ç¬¦ä¸²')</code>ä½¿ç”¨åŠ¨æ€æ‹¼æ¥çš„å‘½ä»¤</li>
                <li><code>child_process.execSync('å‘½ä»¤å­—ç¬¦ä¸²')</code>ä½¿ç”¨åŠ¨æ€æ‹¼æ¥çš„å‘½ä»¤</li>
                <li><code>require('child_process').execFile('å‘½ä»¤å­—ç¬¦ä¸²')</code>ä½¿ç”¨åŠ¨æ€æ‹¼æ¥çš„å‘½ä»¤</li>
            </ul>
            <p>è§„åˆ™ä¼šæ£€æŸ¥å‘½ä»¤å‚æ•°æ˜¯å¦ä¸ºæ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆTemplateLiteralï¼‰æˆ–äºŒå…ƒè¡¨è¾¾å¼ï¼ˆBinaryExpressionï¼Œå¦‚å­—ç¬¦ä¸²æ‹¼æ¥ï¼‰ï¼Œè¿™äº›éƒ½æ˜¯æ½œåœ¨çš„å‘½ä»¤æ³¨å…¥é£é™©ç‚¹ã€‚</p>
        </div>
        
        <h3>5.4 SARIFæŠ¥å‘Šæ ¼å¼</h3>
        <p>SARIFï¼ˆStatic Analysis Results Interchange Formatï¼‰æ˜¯ä¸€ç§ç”¨äºé™æ€åˆ†æå·¥å…·ç»“æœäº¤æ¢çš„æ ‡å‡†æ ¼å¼ã€‚æœ¬å·¥å…·æ”¯æŒç”ŸæˆSARIFæ ¼å¼æŠ¥å‘Šï¼Œä¾¿äºä¸å…¶ä»–å·¥å…·é›†æˆå’Œåˆ†æã€‚</p>
        
        <h2>6. å¼€å‘çŠ¶æ€</h2>
        
        <h3>6.1 å·²å®ŒæˆåŠŸèƒ½</h3>
        <ul>
            <li>åŸºç¡€æ¡†æ¶æ­å»ºï¼ˆé¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®ã€æ ¸å¿ƒæ¥å£ï¼‰</li>
            <li>é™æ€åˆ†æå™¨æ ¸å¿ƒåŠŸèƒ½ï¼ˆè§£æã€éå†ã€è§„åˆ™æ£€æŸ¥ï¼‰</li>
            <li>åŸºç¡€è§„åˆ™å®ç°ï¼ˆno-varã€no-console-logï¼‰</li>
            <li>å®‰å…¨è§„åˆ™å®ç°ï¼ˆno-command-injectionï¼‰</li>
            <li>æ§åˆ¶å°æŠ¥å‘Šç”Ÿæˆ</li>
            <li>SARIFæ ¼å¼æŠ¥å‘Šç”Ÿæˆ</li>
            <li>æ–‡ä»¶ç³»ç»Ÿå·¥å…·å‡½æ•°</li>
            <li>CLIå‘½ä»¤è¡Œå·¥å…·</li>
            <li>å‚æ•°éªŒè¯å’Œå¤„ç†</li>
            <li>æµ‹è¯•ç”¨ä¾‹</li>
            <li>æŠ€æœ¯æ–‡æ¡£</li>
        </ul>
        
        <h2>7. ä½¿ç”¨è¯´æ˜</h2>
        
        <h3>7.1 å®‰è£…ä¾èµ–</h3>
        <pre><code>bun install</code></pre>
        
        <h3>7.2 é€šè¿‡ä¸»å…¥å£æ–‡ä»¶è¿è¡Œ</h3>
        <pre><code>bun run src/main.ts &lt;æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„&gt;</code></pre>
        <p>ä¾‹å¦‚ï¼š</p>
        <pre><code>bun run src/main.ts test-case/test.js</code></pre>
        <p>è¿è¡Œåä¼šåˆ†ææŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¹¶åŒæ—¶ç”Ÿæˆæ§åˆ¶å°æŠ¥å‘Šå’ŒSARIFæ ¼å¼æŠ¥å‘Šã€‚</p>
        
        <h3>7.3 ä½¿ç”¨CLIå·¥å…·</h3>
        <pre><code>bun run src/cli/index.ts &lt;æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„&gt; [é€‰é¡¹]</code></pre>
        
        <h4>7.3.1 CLIé€‰é¡¹è¯´æ˜</h4>
        <ul>
            <li><code>&lt;path&gt;</code>ï¼šè¦åˆ†æçš„æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„ï¼ˆå¿…å¡«ï¼‰</li>
            <li><code>-f, --format &lt;format&gt;</code>ï¼šæŠ¥å‘Šæ ¼å¼ï¼Œå¯é€‰å€¼ä¸ºconsoleæˆ–sarifï¼ˆé»˜è®¤åŒæ—¶ç”Ÿæˆä¸¤ç§æ ¼å¼ï¼‰</li>
            <li><code>-r, --rules &lt;rules&gt;</code>ï¼šè¦ä½¿ç”¨çš„è§„åˆ™ï¼Œç”¨é€—å·åˆ†éš”ï¼ˆé»˜è®¤ä½¿ç”¨æ‰€æœ‰è§„åˆ™ï¼‰</li>
            <li><code>-s, --silent</code>ï¼šé™é»˜æ¨¡å¼ï¼Œä¸è¾“å‡ºæ§åˆ¶å°ä¿¡æ¯ï¼ˆåªå½±å“consoleæŠ¥å‘Šï¼‰</li>
        </ul>
        
        <h4>7.3.2 ç¤ºä¾‹</h4>
        <ul>
            <li>åˆ†æå•ä¸ªæ–‡ä»¶ï¼š</li>
            <pre><code>bun run src/cli/index.ts test-case/test.js</code></pre>
            
            <li>åˆ†ææ•´ä¸ªç›®å½•ï¼š</li>
            <pre><code>bun run src/cli/index.ts src/</code></pre>
            
            <li>åªç”ŸæˆSARIFæ ¼å¼æŠ¥å‘Šï¼š</li>
            <pre><code>bun run src/cli/index.ts test-case/test.js --format sarif</code></pre>
            
            <li>åªä½¿ç”¨ç‰¹å®šè§„åˆ™ï¼š</li>
            <pre><code>bun run src/cli/index.ts test-case/test.js --rules no-var,no-command-injection</code></pre>
            
            <li>é™é»˜æ¨¡å¼ï¼š</li>
            <pre><code>bun run src/cli/index.ts test-case/test.js --silent</code></pre>
        </ul>
        
        <h2>8. è¾“å‡ºç¤ºä¾‹</h2>
        
        <h3>8.1 æ§åˆ¶å°æŠ¥å‘Šç¤ºä¾‹</h3>
        <pre><code>âŒ å‘ç°é—®é¢˜ï¼š
============================================================

ğŸ“ æ–‡ä»¶: test-case/test.js
------------------------------------------------------------
  ğŸš¨ [no-var] ç¦æ­¢ä½¿ç”¨varå…³é”®å­—ï¼Œè¯·ä½¿ç”¨letæˆ–const
     ä½ç½®: ç¬¬ 4 è¡Œ, ç¬¬ 0 åˆ—
  ğŸš¨ [no-console-log] ç¦æ­¢ä½¿ç”¨console.log
     ä½ç½®: ç¬¬ 6 è¡Œ, ç¬¬ 0 åˆ—
  ğŸš¨ [no-var] ç¦æ­¢ä½¿ç”¨varå…³é”®å­—ï¼Œè¯·ä½¿ç”¨letæˆ–const
     ä½ç½®: ç¬¬ 9 è¡Œ, ç¬¬ 2 åˆ—
  ğŸš¨ [no-console-log] ç¦æ­¢ä½¿ç”¨console.log
     ä½ç½®: ç¬¬ 10 è¡Œ, ç¬¬ 2 åˆ—
  ğŸš¨ [no-command-injection] ä¸å®‰å…¨çš„å‘½ä»¤æ‰§è¡Œï¼šexec ä½¿ç”¨äº†åŠ¨æ€æ‹¼æ¥çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œå­˜åœ¨å‘½ä»¤æ³¨å…¥é£é™©
     ä½ç½®: ç¬¬ 18 è¡Œ, ç¬¬ 0 åˆ—
  ğŸš¨ [no-command-injection] ä¸å®‰å…¨çš„å‘½ä»¤æ‰§è¡Œï¼šexecSync ä½¿ç”¨äº†åŠ¨æ€æ‹¼æ¥çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œå­˜åœ¨å‘½ä»¤æ³¨å…¥é£é™©
     ä½ç½®: ç¬¬ 19 è¡Œ, ç¬¬ 0 åˆ—
  ğŸš¨ [no-command-injection] ä¸å®‰å…¨çš„å‘½ä»¤æ‰§è¡Œï¼šrequire('child_process').execFile ä½¿ç”¨äº†åŠ¨æ€æ‹¼æ¥çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œå­˜åœ¨å‘½ä»¤æ³¨å…¥é£é™©
     ä½ç½®: ç¬¬ 20 è¡Œ, ç¬¬ 0 åˆ—

============================================================
æ€»è®¡: 7 ä¸ªé—®é¢˜
âœ… SARIFæŠ¥å‘Šå·²ä¿å­˜åˆ°: sarif.json
</code></pre>
        
        <h3>8.2 SARIFæŠ¥å‘Šç¤ºä¾‹</h3>
        <p>SARIFæŠ¥å‘Šæ˜¯JSONæ ¼å¼çš„æ–‡ä»¶ï¼ŒåŒ…å«è¯¦ç»†çš„åˆ†æç»“æœå’Œå…ƒæ•°æ®ã€‚ç¤ºä¾‹æŠ¥å‘Šå¦‚ä¸‹ï¼ˆéƒ¨åˆ†å†…å®¹ï¼‰ï¼š</p>
        <pre><code>{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "JS/TS Static Analyzer",
          "fullName": "åŸºäºBunå’ŒBabelçš„JS/TSé™æ€åˆ†æå·¥å…·",
          "version": "1.0.0",
          "informationUri": "https://github.com/user/jsast",
          "rules": [
            {
              "id": "no-var",
              "name": "no-var",
              "shortDescription": {
                "text": "ç¦æ­¢ä½¿ç”¨varå…³é”®å­—"
              },
              "helpUri": "https://example.com/rules/no-var",
              "properties": {
                "severity": "warning"
              }
            },
            ...
          ]
        }
      },
      "results": [
        {
          "ruleId": "no-var",
          "message": {
            "text": "ç¦æ­¢ä½¿ç”¨varå…³é”®å­—ï¼Œè¯·ä½¿ç”¨letæˆ–const"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "test-case/test.js"
                },
                "region": {
                  "startLine": 4,
                  "startColumn": 0,
                  "endLine": 4,
                  "endColumn": 0
                }
              }
            }
          ],
          "level": "warning"
        },
        ...
      ],
      "columnKind": "utf16CodeUnits"
    }
  ]
}
</code></pre>
        
        <h2>9. æ‰©å±•ä¸å¼€å‘</h2>
        
        <h3>9.1 æ·»åŠ æ–°è§„åˆ™</h3>
        <ol>
            <li>åœ¨<code>src/rules/</code>ç›®å½•ä¸‹åˆ›å»ºæ–°çš„è§„åˆ™æ–‡ä»¶ï¼ˆå¦‚<code>new-rule.ts</code>ï¼‰</li>
            <li>å®ç°Ruleæ¥å£ï¼Œå®šä¹‰è§„åˆ™åç§°ã€æè¿°å’Œæ£€æŸ¥é€»è¾‘</li>
            <li>åœ¨<code>src/rules/index.ts</code>ä¸­å¯¼å‡ºæ–°è§„åˆ™</li>
        </ol>
        
        <h3>9.2 æ‰©å±•æŠ¥å‘Šæ ¼å¼</h3>
        <ol>
            <li>åœ¨<code>src/report/</code>ç›®å½•ä¸‹åˆ›å»ºæ–°çš„æŠ¥å‘Šç”Ÿæˆå™¨æ–‡ä»¶</li>
            <li>å®ç°æŠ¥å‘Šç”Ÿæˆé€»è¾‘</li>
            <li>åœ¨<code>src/report/index.ts</code>ä¸­å¯¼å‡ºæ–°çš„æŠ¥å‘Šç”Ÿæˆå™¨</li>
            <li>åœ¨<code>src/cli/runner.ts</code>ä¸­æ·»åŠ å¯¹æ–°æŠ¥å‘Šæ ¼å¼çš„æ”¯æŒ</li>
        </ol>
        
        <h2>10. æœªæ¥è®¡åˆ’</h2>
        <ul>
            <li>æ·»åŠ æ›´å¤šå®‰å…¨è§„åˆ™ï¼ˆå¦‚SQLæ³¨å…¥ã€XSSæ£€æµ‹ç­‰ï¼‰</li>
            <li>æ”¯æŒé…ç½®æ–‡ä»¶ï¼ˆå¦‚.jsastrcï¼‰</li>
            <li>æ”¯æŒå¿½ç•¥ç‰¹å®šæ–‡ä»¶æˆ–ä»£ç æ®µ</li>
            <li>ä¼˜åŒ–æ€§èƒ½å’Œåˆ†æé€Ÿåº¦</li>
            <li>æ·»åŠ å•å…ƒæµ‹è¯•</li>
            <li>æ”¯æŒæ›´å¤šæŠ¥å‘Šæ ¼å¼</li>
            <li>é›†æˆCI/CDæµç¨‹</li>
        </ul>
    </div>
</body>
</html>